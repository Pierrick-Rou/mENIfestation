{% extends 'base.html.twig' %}

{% block body %}

    <div class="form participant-info">
        <h2>{{ sortie.nom }}</h2>
        <p>
            Organisateur:
            <a href="{{ path('app_profil_details', {'id': sortie.organisateur.id}) }}">
                {{ sortie.organisateur.prenom }} {{ sortie.organisateur.nom }}
            </a>
        </p>

        <p>
            {{ sortie.dateHeureDebut|date('d/m/Y - H:i') }} ({{ sortie.etat.value }})<br>
            Durée : {{ sortie.duree|date('H:i') }}
        </p>
        <p>
            RDV : {{ sortie.lieu.nom }}<br><br>
            {{ sortie.lieu.rue }}<br>
            {{ sortie.lieu.ville.codePostal }} {{ sortie.lieu.ville.nom }}
        </p>
        <p>
            {{ sortie.infosSortie }}<br><br>
            Inscription jusqu'au {{ sortie.dateLimiteInscription|date('d/m/Y - H:i') }}<br>
            Nombre de place : {{ sortie.nbInscriptionMax }}
        </p>

        <p>Participants : {{ nbParticipant }}</p>
        <div class="participants">
            {% for p in sortie.participant %}
                <a href="{{ path('app_profil_details', {'id': p.id }) }}" class="badge"
                   data-info="{{ p.nom }} - {{ p.email }}">
                    {{ p.nom }}
                </a>
            {% endfor %}
        </div>

        {% if is_granted('IS_AUTHENTICATED') %}
            {% if app.user.id != sortie.organisateur.id %}
                {% if etat == constant('App\\Enum\\EtatSortie::OUVERTE') %}
                    {% if not isRegistered %}
                        <a href="{{ path('app_sortie_inscription', {'id': sortie.id}) }}">
                            <button>S'inscrire à l'évènement</button>
                        </a>
                    {% else %}
                        <a href="{{ path('app_sortie_inscription', {'id': sortie.id}) }}">
                            <button>Se déinscrire de l'évènement</button>
                        </a>
                    {% endif %}
                {% else %}
                    <p>Vous ne pouvez pas vous inscrire à cet évènement</p>
                {% endif %}
            {% else %}
                <a href="{{ path('app_sortie_delete', {'id': sortie.id}) }}">
                    <button>Supprimer sortie</button>
                </a>
            {% endif %}
        {% endif %}
    </div>

{% endblock %}
