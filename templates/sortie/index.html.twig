{% extends 'base.html.twig' %}

{% block title %}Hello SortieController!{% endblock %}
{% block script %}{{ importmap('app') }}{% endblock %}
{% block body %}

    <div class="table-container" style="z-index: 1;">
        <h2>Les Sorties</h2>
        <div class="filter-bar">
            <div class="form filter">

                {{ form(filtreForm) }}
            </div>
        </div>
        <div class="view-switch">
            <a href="{{ path('app_sortie_home', app.request.query.all|merge({'view': 'list'})) }}"
               class="{{ viewMode == 'list' ? 'active' : '' }}">
                Liste
            </a>
            <a href="{{ path('app_sortie_home', app.request.query.all|merge({'view': 'map'})) }}"
               class="{{ viewMode == 'map' ? 'active' : '' }}">
                Carte
            </a>
            <a href="{{ path('app_sortie_home', app.request.query.all|merge({'view': 'calendar'})) }}"
               class="{{ viewMode == 'calendar' ? 'active' : '' }}">
                Calendrier
            </a>
        </div>

        {% if sortieList is empty %}
            <h4>Pas de sortie</h4>
        {% else %}

            {% set availableViews = ['list', 'map', 'calendar'] %}

            {% if viewMode in availableViews %}
                {% if viewMode == 'calendar' %}
                    {% include 'sortie/_calendar.html.twig' with calendarData %}
                {% else %}
                    {% include 'sortie/_' ~ viewMode ~ '.html.twig' %}
                {% endif %}
            {% else %}
                {# fallback si une vue inconnue est demand√©e #}
                {% include 'sortie/_list.html.twig' %}
            {% endif %}

        {% endif %}

    </div>
{% endblock %}
